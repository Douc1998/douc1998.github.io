---
title: åŸºäºReactå®ç°ã€Šè´ªåƒè›‡ã€‹å°æ¸¸æˆ
date: 2022-04-28 10:03:54
tags: 
    - å‰ç«¯
    - React
    - JavaScript
categories: React  # ç±»åˆ«
comments: true  # å¼€å¯è¯„è®º
toc: true  # æ˜¾ç¤ºæ–‡å­—toc
top_img: https://fastly.jsdelivr.net/gh/Douc1998/CDN-source/image/background/GreedySnake.png  # æ–‡ç« é¡µå¤´éƒ¨å›¾ç‰‡
cover: https://fastly.jsdelivr.net/gh/Douc1998/CDN-source/image/background/GreedySnake.png   # ä¸»é¡µä¸­æ˜¾ç¤ºçš„æ–‡ç« å°é¢å›¾ç‰‡
keywords: "Reactï¼ŒJavaScriptï¼Œå‰ç«¯ï¼Œè´ªåƒè›‡"
---
# å‰è¨€
åœ¨å†™è‡ªå·±çš„ç½‘é¡µçš„æ—¶å€™ï¼Œçªç„¶æƒ³åˆ°å†™å‡ ä¸ªæ€€æ—§å°æ¸¸æˆï¼Œæ¯”å¦‚è´ªåƒè›‡ï¼ˆè¯¥æ•™ç¨‹ï¼‰ã€æ¨ç®±å­ï¼ˆ[å·²å‡ºæ•™ç¨‹](https://blog.douchen.life/Reactæ¨ç®±å­å°æ¸¸æˆ/)ï¼‰ã€ä¿„ç½—æ–¯æ–¹å—ç­‰ã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘å°†ç®€å•è°ˆä¸€è°ˆå¦‚ä½•åŸºäº [React](https://zh-hans.reactjs.org/) å®ç°**è´ªåƒè›‡**å°æ¸¸æˆã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š
> 1. é™æ€è®¾ç½®
> 2. æ¸¸æˆç®—æ³•
> 3. React æ¸²æŸ“

# é™æ€è®¾ç½®
å—é™äºæˆ‘çš„è¯­æ–‡åŠŸåº•ï¼Œç”¨â€œé™æ€è®¾ç½®â€æ¥æè¿°å¯èƒ½ä¸å¤ªå‡†ç¡®ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæˆ‘ä»¬**éœ€è¦å®šä¹‰å“ªäº›é™æ€çŠ¶æ€ï¼Ÿå“ªäº›å¯¹è±¡ï¼Ÿ**ã€‚å¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°ï¼š**æ–¹å‘**ï¼Œ**åœ°å›¾ç‰©å“**ï¼Œ**Pointå¯¹è±¡**ç­‰ã€‚

æˆ‘ä»¬çš„è´ªåƒè›‡æ¸¸æˆæ˜¯2Dçš„ï¼Œå› æ­¤æˆ‘ä»¬è›‡å¯ä»¥ç§»åŠ¨çš„æ–¹å‘åªæœ‰ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³ã€‚è¿™å››ä¸ªæ–¹å‘æ˜¯é™æ€ä¸å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆå†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œå°†å®ƒä»¬å®šä¹‰å¥½ï¼Œå¦‚ä¸‹ï¼š
```js
// è´ªåƒè›‡ç§»åŠ¨çš„æ–¹å‘ æšä¸¾
export default class Direction {
    /**
     * Direction static params
     * @param {string} UP - å‘ä¸Šç§»åŠ¨
     * @param {string} DOWN - å‘ä¸‹ç§»åŠ¨
     * @param {string} LEFT - å‘å·¦ç§»åŠ¨
     * @param {string} RIGHT - å‘å³ç§»åŠ¨
     */
    static UP = 'UP';
    static DOWN = 'DOWN';
    static LEFT = 'LEFT';
    static RIGHT = 'RIGHT';
}
```

æ­¤å¤–ï¼Œè´ªåƒè›‡æ¸¸æˆä¸­çš„ç‰©å“ä¸»è¦åŒ…æ‹¬ï¼šç©ºåœ°ã€éšœç¢ç‰©ã€è›‡ï¼ˆä½ å¯ä»¥åˆ†ä¸ºè›‡å¤´å’Œè›‡èº«ï¼Œè¿™æ ·æœ‰åˆ©äºä¹‹åç»˜åˆ¶ï¼‰ã€é£Ÿç‰©ã€‚å¦‚ä¸‹ï¼š

```js
// åœ°å›¾æ ¼ç½‘å±æ€§ æšä¸¾
export default class MapGoods {
    /**
     * MapGoods static params
     * @param {string} BLANK - ç©º
     * @param {string} BARRIER - éšœç¢
     * @param {string} SNAKE_HEAD - è›‡å¤´
     * @param {string} SNAKE_BODY - è›‡èº«ä½“
     * @param {string} FOOD - é£Ÿç‰©
    */
    static BLANK = 'BLANK';
    static BARRIER = 'BARRIER';
    static SNAKE_HEAD = 'SNAKE_HEAD';
    static SNAKE_BODY = 'SNAKE_BODY';
    static FOOD = 'FOOD';
}
```

æœ€åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®šé™æ€ç±»ï¼Œå³ `Point` ç±»ã€‚å› ä¸ºæˆ‘ä»¬çš„åœ°å›¾å®é™…ä¸Šå°±æ˜¯ä¸€ç³»åˆ—çš„æ ¼ç½‘ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—çš„ `Point` å¯¹è±¡ç»„æˆï¼Œåªä¸è¿‡è¿™äº›å¯¹è±¡çš„åœ°å›¾å±æ€§ä¸åŒï¼Œæœ‰ç©ºåœ°ã€éšœç¢ã€è›‡ç­‰ç­‰ã€‚æˆ‘ä»¬çš„ `Point` å¯¹è±¡åŒ…æ‹¬ä¸¤ä¸ªå±æ€§ï¼Œå³**è¡Œå·**å’Œ**åˆ—å·**ã€‚

```js
// å®šä¹‰Pointç±», å…·æœ‰è¡Œå·rã€åˆ—å·c
export default class Point {
    /**
     * params
     * @param {number} r - ç‚¹åœ¨äºŒç»´æ•°ç»„ä¸­çš„è¡Œå·
     * @param {number} c - ç‚¹åœ¨äºŒç»´æ•°ç»„ä¸­çš„åˆ—å·
     */
    constructor(r = 0, c = 0) {
        this.r = r;
        this.c = c;
    }
}
```

# æ¸¸æˆç®—æ³•
è´ªåƒè›‡çš„ç®—æ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä¸»è¦å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š
>**1. åŸºäºé”®ç›˜ç›‘å¬äº‹ä»¶åˆ¤æ–­è›‡çš„ç§»åŠ¨**
>**2. é£Ÿç‰©ï¼ˆå¥–åŠ±ï¼‰çš„ç”Ÿæˆ**
>**3. è›‡çš„é•¿åº¦å˜åŒ–**
>**4. è›‡çš„çŠ¶æ€åˆ¤æ–­**


## åŸºäºé”®ç›˜ç›‘å¬äº‹ä»¶åˆ¤æ–­è›‡çš„ç§»åŠ¨
æˆ‘ä»¬ç”¨ç”µè„‘æ“ä½œè´ªåƒè›‡çš„ç§»åŠ¨ï¼Œå› æ­¤éœ€è¦ç»™ç½‘é¡µæ·»åŠ ä¸Šé”®ç›˜ç›‘å¬äº‹ä»¶ï¼Œ**é€šè¿‡ç›‘å¬åˆ°é”®ç›˜çš„å“åº”ï¼Œåˆ¤æ–­å‡ºè›‡ä¸‹ä¸€æ­¥è¯¥å¦‚ä½•ç§»åŠ¨**ã€‚ç„¶è€Œï¼Œè¿™é‡Œä¹Ÿæœ‰å‡ ä¸ªæ³¨æ„ç‚¹ï¼Œå¦‚ï¼š

**1. æŒ‰é”®æ–¹å‘å’Œå½“å‰æ–¹å‘æ˜¯å¦çŸ›ç›¾**

è€ƒè™‘è¿™ä¸€ç‚¹çš„åŸå› æ˜¯ï¼Œåœ¨è›‡çš„é•¿åº¦ä¸ä¸º1æ—¶ï¼Œæˆ‘ä»¬çš„è›‡æ˜¯ä¸èƒ½éšæ„â€œæ‰å¤´â€çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“æˆ‘ä»¬çš„è›‡å‘å³è¾¹ç§»åŠ¨æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ä¸‹å·¦é”®ï¼Œè¿™ä¸ªæ—¶å€™**æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯æ— å“åº”**ï¼Œç»§ç»­ä¿æŒè›‡å‘åŒä¸€ä¸ªæ–¹å‘è¿åŠ¨ã€‚ä»£ç å¦‚ä¸‹ï¼š
```js
/**
 * åˆ¤æ–­æ˜¯å¦å¯ä»¥è½¬å‘ => ä¸»è¦è€ƒè™‘ â€œæ‰å¤´å°±èµ°â€ çš„æƒ…å†µ
 * @param oldDirection
 * @param newDirection
 * @return {Boolean}
 */
canChangeDirection = (oldDirection, newDirection) => {
    switch (oldDirection) {
        case Direction.UP:
            return !(newDirection === Direction.DOWN);
        case Direction.DOWN:
            return !(newDirection === Direction.UP);
        case Direction.LEFT:
            return !(newDirection === Direction.RIGHT);
        case Direction.RIGHT:
            return !(newDirection === Direction.LEFT);
        default:
            return false;
    }
}
```

**2. æŒ‰é”®æ–¹å‘å’Œå½“å‰æ–¹å‘æ˜¯å¦ç›¸åŒ**
è¿™ä¸ªæ­¥éª¤ä¸»è¦çœ‹æ¸¸æˆè®¾è®¡è€…å¸Œä¸å¸Œæœ›å¢åŠ æ¸¸æˆéš¾åº¦ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœæŒ‰é”®çš„æ–¹å‘å’Œå½“å‰ç§»åŠ¨æ–¹å‘æ˜¯ç›¸åŒçš„è¯ï¼Œåº”è¯¥æ˜¯**æ— å“åº”**çš„ï¼Œè›‡ç»§ç»­æŒ‰ç…§ç›¸åŒé€Ÿåº¦å¹¶ä¿æŒè¯¥æ–¹å‘ç§»åŠ¨ã€‚ä½†å¦‚æœä½ å¸Œæœ›å¢åŠ ä¸€ç‚¹æ¸¸æˆéš¾åº¦çš„è¯ï¼Œä½ å¯ä»¥è®¾è®¡ä¸ºï¼š**å¦‚æœæ–¹å‘ç›¸åŒï¼Œåˆ™è›‡â€œå¿«è¿›â€ä¸€ä¸‹**ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥ä¸»è¦çœ‹ä½ æ€ä¹ˆè®¾è®¡å’¯ï¼ˆä¸æ˜¯é‡ç‚¹ï¼‰ã€‚

## é£Ÿç‰©ï¼ˆå¥–åŠ±ï¼‰çš„ç”Ÿæˆ
è´ªåƒè›‡æ¸¸æˆæ“æ§è›‡çš„ç›®æ ‡å°±æ˜¯ä¸ºäº†**åƒåˆ°é£Ÿç‰©**ï¼å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åœ°å›¾ä¸­å¸ƒç½®é£Ÿç‰©ã€‚è¿™é‡Œæˆ‘å°±é€šè¿‡ä¸€ä¸ªæœ€ç®€å•çš„æ–¹æ³•æ¥ç”Ÿæˆé£Ÿç‰©ï¼š**éšæœºç”Ÿæˆ**ã€‚éšæœºç”Ÿæˆçš„æ€è·¯å°±æ˜¯ï¼š
> 1. åˆ©ç”¨éšæœºæ•°æ‰¾åˆ°åœ°å›¾ä¸Šçš„æŸä¸€ä¸ªä½ç½®ã€‚
> 2. åˆ¤æ–­è¯¥ä½ç½®æ˜¯ä¸æ˜¯ â€œç©ºåœ°â€ å±æ€§ï¼Œå¦‚æœæ˜¯åˆ™ç”Ÿæˆï¼Œå¦‚æœä¸æ˜¯åˆ™é‡å¤æ­¥éª¤1ã€‚
é€»è¾‘å¾ˆç®€å•ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª**ä¸æ–­ç”Ÿæˆéšæœºæ•°ï¼Œä¸æ–­åˆ¤æ–­ï¼Œç›´åˆ°ç¬¦åˆæ¡ä»¶**çš„è¿‡ç¨‹ã€‚éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š
```js
/**
 * åœ¨åœ°å›¾ä¸­éšæœºç”Ÿæˆä¸€ä¸ªé£Ÿç‰©åæ ‡ï¼Œä¸ä¼šåœ¨å¢™å£æˆ–è€…snakeçš„ä½ç½®ç”Ÿæˆ
 * @return {Point}
 */
addFoodToWorld = () => {
    let foodPoint;
    // åªè¦ç”Ÿæˆçš„éšæœºç‚¹æ­£åœ¨è¢«worldæˆ–è€…snakeä½¿ç”¨ï¼Œå°±é‡æ–°ç”Ÿæˆ
    do {
        foodPoint = this.getRandomPoint();
    } while (!this.isPointBlank(foodPoint));

    return foodPoint;
}

/**
 * åœ¨åœ°å›¾ä¸­éšæœºç”Ÿæˆä¸€ä¸ªç‚¹
 * @return {Point}
 */
getRandomPoint = () => {
    const r = Math.round(Math.random() * (this.rows - 1));
    const c = Math.round(Math.random() * (this.cols - 1));
    return new Point(r, c);
}

/**
 * åˆ¤æ–­ä¸€ä¸ªç‚¹æœ‰æ²¡æœ‰è¢«ä½¿ç”¨
 * @param point
 * @return {boolean}
 */
isPointBlank = (point) => {
    return this.world[point.r][point.c] === MapGoods.BLANK;
}
```

## è›‡çš„é•¿åº¦å˜åŒ–
è›‡çš„é•¿åº¦å˜åŒ–è¿™ä¸€é—®é¢˜ä¸»è¦å‡ºç°åœ¨**è›‡åƒåˆ°é£Ÿç‰©**çš„æ¡ä»¶ä¸‹ã€‚å¦‚æœè›‡æ²¡æœ‰åƒåˆ°ä¸œè¥¿ï¼Œåˆ™é•¿åº¦å¹¶ä¸ä¼šå˜åŒ–ã€‚**ä¸€æ—¦æˆ‘ä»¬çš„è›‡ä¸‹ä¸€æ—¶åˆ»åƒåˆ°äº†é£Ÿç‰©ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„è›‡çš„é•¿åº¦å°† + 1**ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦å®ç°çš„å°±æ˜¯ï¼š**è›‡å¤´å’Œè›‡èº«ä½“ä½ç½®çš„å˜æ¢**ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥è½¬åŒ–ä¸º**æ•°ç»„çš„é¡ºåºç§»åŠ¨**ã€‚éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š
```js
/**
 * åƒæŸä¸ªæ–¹å‘ç§»åŠ¨ä¸€ä¸‹è›‡ã€‚
 * @param direction {Direction}
 * @param eatFood {boolean} æ˜¯å¦åƒåˆ°äº†é£Ÿç‰©
 */
moveStep(direction, eatFood) {
    const head = this.head;
    const body = this.body;
    const neck = this.body[0];
    // è®°å½•è›‡èº«çš„å°¾å·´, ç”¨äºåç»­æ’å…¥åˆ°bodyæ•°ç»„ä¸­
    const oldTail = body.length === 0 ? head : _.cloneDeep(body[body.length - 1]);

    // é¦–å…ˆå°†è›‡èº«å€’åºä¾æ¬¡å‘å‰ç§»åŠ¨
    for (let i = body.length - 1; i > 0; i--) {
        body[i].r = body[i - 1].r;
        body[i].c = body[i - 1].c;
    }
    // å¦‚æœè›‡é•¿åº¦ä¸ä¸º1, å³æœ‰body => è„–å­ä½ç½®ç§»åŠ¨åˆ°è›‡å¤´
    if (neck != null) {
        neck.r = head.r;
        neck.c = head.c;
    }

    // å¦‚æœåƒåˆ°äº†ä¸œè¥¿ï¼Œæ–°å¢é•¿åº¦å°±æ˜¯åŸæ¥å°¾å·´çš„ä½ç½®
    if (eatFood) {
        body.push(oldTail);
    }
    
    // è›‡å¤´æ ¹æ®æ–¹å‘ç§»åŠ¨
    this.head = this.getNextHead(direction)
}

/**
 * è·å–ä¸‹ä¸€æ­¥ è›‡å¤´ è¿åŠ¨çš„ä½ç½®
 * @param direction
 * @return {boolean|{x: number, y: number}}
 */
getNextHead(direction) {
    const realHead = this.head;
    const nextHead = new Point(realHead.r, realHead.c);

    switch (direction) {
        case Direction.UP:
            nextHead.r -= 1;
            break;
        case Direction.DOWN:
            nextHead.r += 1;
            break;
        case Direction.LEFT:
            nextHead.c -= 1;
            break;
        case Direction.RIGHT:
            nextHead.c += 1;
            break;
    }
    return nextHead;
}
```
## è›‡çš„çŠ¶æ€åˆ¤æ–­
è›‡çš„çŠ¶æ€åˆ¤æ–­ä¹Ÿå°±æ˜¯**åˆ¤æ–­è›‡æ˜¯å¦æ­»äº¡**ï¼Œä¸»è¦å°±æ˜¯åˆ¤æ–­ä¸¤ç§å¯èƒ½æ€§ï¼š

> 1. è›‡å¤´æ˜¯å¦æ’åˆ°éšœç¢ç‰©ã€‚
> 2. è›‡å¤´æ˜¯å¦æ’åˆ°è›‡çš„èº«ä½“ã€‚

è¿™é‡Œæˆ‘ä»¬éœ€è¦å…ˆè·å–åˆ°è›‡çš„ä¸‹ä¸€ä¸ªç§»åŠ¨ä½ç½®ï¼Œå†è¿›è¡Œåˆ¤æ–­ã€‚éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š
```js
/**
 * åˆ¤æ–­è›‡æ˜¯ä¸æ˜¯æ­»äº†
 * @param isHead {direction} ç§»åŠ¨åçš„è›‡å¤´ä½ç½®ï¼Œå› ä¸ºæ¯æ¬¡ç§»åŠ¨ï¼Œéƒ½æ˜¯è›‡å¤´åœ¨æœ€å‰é¢ï¼Œæ‰€ä»¥åªåˆ¤æ–­è›‡å¤´ä½ç½®å°±å¯ä»¥
 */
isDead = (direction) => {
    const { head, body } = this.snake; // è·å–å½“å‰è›‡çš„ä½ç½®
    const nextHead = this.snake.getNextHead(direction); // è·å–è›‡å¤´çš„ä¸‹ä¸€ä½ç½®(å½“æ—¶è¿˜æ²¡ç§»åŠ¨)
    // å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰å’¬åˆ°è‡ªå·±
    for(let i = 0; i < body.length; i++){
        if(nextHead.r === body[i].r && nextHead.c === body[i].c){
            return true
        }
    }
    // åˆ¤æ–­æœ‰æ²¡æœ‰æ’å¢™
    return this.world[nextHead.r][nextHead.c] === MapGoods.BARRIER;
}
```

# React æ¸²æŸ“
ä¸Šé¢æˆ‘ä»¬å·²ç»æè¿°äº†å°æ¸¸æˆå¿…å¤‡çš„**é™æ€é…ç½®**å’Œ**ç®—æ³•åŸç†**ï¼Œä¸‹é¢æˆ‘ä»¬å°±éœ€è¦åŸºäº `React` æ¥å®ç°ç»„ä»¶ç»˜åˆ¶å’Œé€»è¾‘åº”ç”¨ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š
> 1. æ¸¸æˆåˆå§‹åŒ–é…ç½®
> 2. æ¸¸æˆæ¸²æŸ“
> 3. æ¸¸æˆç»“æŸè®¾ç½®

## æ¸¸æˆåˆå§‹åŒ–é…ç½®
æ¸¸æˆåˆå§‹åŒ–éœ€è¦å¾ˆå¤šå‡†å¤‡å·¥ä½œï¼Œå¦‚ï¼š
> 1. é”®ç›˜ç›‘å¬äº‹ä»¶
> 2. å®šæ—¶å™¨äº‹ä»¶
> 3. åœ°å›¾åˆå§‹åŒ–

**1. é”®ç›˜ç›‘å¬äº‹ä»¶**
æˆ‘ä»¬éœ€è¦ç»™æ•´ä¸ªæ¸¸æˆé¡µé¢æ·»åŠ **é”®ç›˜ç›‘å¬äº‹ä»¶**ï¼Œå¹¶å°†æŒ‰é”®çš„ `keycode` å’Œç§»åŠ¨æ–¹æ³• `Direction` è¿›è¡Œä¸€ä¸€æ˜ å°„ã€‚ä»£ç å¦‚ä¸‹ï¼š
```js
/**
 * é”®ç›˜çš„é”®ç  w(119) a(97) s(115) d(100) è½¬æ¢æˆæ–¹å‘çš„æ“ä½œ
 * @param event
 * @return {string}
 */
keyCodeToDirection = (event) => {
    const e = event || window.event; // æ•è·äº‹ä»¶
    const k = e.keyCode || e.which; // è·å–é”®ç 
    switch (k) {
        case 97:
            return Direction.LEFT;
        case 119:
            return Direction.UP;
        case 100:
            return Direction.RIGHT;
        case 115:
            return Direction.DOWN;
        case 32:
            return 'Stop';
        default:
            return Direction.INVALID;
    }
}
```

**2. å®šæ—¶å™¨äº‹ä»¶**
å½“æ¸¸æˆå¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ç°çš„æ˜¯ï¼š**è›‡æ˜¯ä¿æŒè¿åŠ¨çš„** ğŸ‘‰ å¦‚æœæ²¡æŒ‰é”®ï¼Œè›‡ä¼šæŒ‰ç…§ä¸€å®šé€Ÿåº¦è‡ªåŠ¨å‘åŸæ¥æ–¹å‘è¿åŠ¨ï¼Œç›´åˆ°æ”¹å˜æ–¹å‘è›‡ä¼šå‘è¯¥ä¸€æ–¹å‘è‡ªåŠ¨è¿åŠ¨ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ•´ä¸ªæ¸¸æˆé¡µé¢æ·»åŠ **å®šæ—¶å™¨äº‹ä»¶** ğŸ‘‰ **ä»¥ä¸€å®šçš„é—´éš”é€Ÿåº¦ï¼Œä¸æ–­é‡æ–°æ¸²æŸ“æ¸¸æˆé¡µé¢**ï¼Œä»¥å®ç°è›‡è‡ªåŠ¨è¿åŠ¨ã€‚ä»£ç å¦‚ä¸‹ï¼š
```js
/**
 * å®šæ—¶å™¨, æ¸¸æˆå¼€å§‹ä¹‹å è›‡ä¼šè‡ªåŠ¨è·‘
 */
myTimer = () => {
    // setIntervalä¼šåœ¨ä¸€å®šé—´éš”å†…ä¸æ–­æ‰§è¡Œå…¶ä¸­çš„function
    this.timer = setInterval(() => {
        const { moveDirection, start } = this.state;
        if (start) {
            this.move(moveDirection);
        }
    }, this.state.speedInterval);
};
```

**3. åœ°å›¾åˆå§‹åŒ–**
æˆ‘ä»¬çš„æ¸¸æˆåœ°å›¾æ˜¯ **2D æ ¼ç½‘**ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ’åˆ—æ ¼ç½‘ï¼ˆåŸºäº CSS çš„ `float` å¸ƒå±€å®ç°ï¼‰ã€‚

ç„¶ååŸºäºä¸Šè¿°çš„**åœ°å›¾å±æ€§**ï¼Œç»˜åˆ¶ä¸åŒçš„é¢œè‰²ï¼Œå¦‚éšœç¢ç‰©è®¾ç½®ä¸ºç°è‰²ï¼Œè›‡å¤´è®¾ç½®ä¸ºçº¢è‰²ï¼Œé£Ÿç‰©è®¾ç½®ä¸ºé»„è‰²ç­‰ã€‚æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š

![åœ°å›¾åˆå§‹åŒ–](./Reactè´ªåƒè›‡å°æ¸¸æˆ/initMap.png)

## æ¸¸æˆæ¸²æŸ“
åˆšåˆšæˆ‘ä»¬æåˆ°ï¼Œæˆ‘ä»¬ä¼šåœ¨å®šæ—¶å™¨äº‹ä»¶ä¸­è®¾å®šä¸€å®šçš„æ—¶é—´é—´éš”ï¼ŒæŒ‰ç…§è¿™ä¸ªæ—¶é—´é‡å¤æ¸²æŸ“æ¸¸æˆé¡µé¢ï¼Œä»¥å®ç°åŠ¨æ€æ•ˆæœã€‚

ç”±äºæˆ‘ä»¬çš„æ¯ä¸€ä¸ªæ ¼ç½‘æ˜¯ç”± `div` å…ƒç´ å®ç°çš„ï¼Œå› æ­¤æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ï¼š
> 1. æ¸…é™¤ä¸Šä¸€æ—¶åˆ» `DOM` èŠ‚ç‚¹å†…å®¹ã€‚
> 2. å‘ `DOM` èŠ‚ç‚¹ä¸­æ·»åŠ æ–°å†…å®¹ã€‚
> 3. é‡æ–°æ¸²æŸ“ã€‚

é‡ç‚¹åœ¨äº**å‘ DOM ä¸­åŠ¨æ€æ·»åŠ å…ƒç´ **ï¼Œä½ ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ç»˜åˆ¶æ–¹æ³•ï¼Œå¦‚ `canvas` ç”»å¸ƒã€‚ä»£ç å¦‚ä¸‹ï¼š
```js
// åˆ·æ–° é‡æ–°æ¸²æŸ“ => åŠ¨æ€æ·»åŠ divå­å…ƒç´ 
reRender = () => {
    const divDom = this.game.current;
    divDom.innerHTML = ''; // æ¸…é™¤å½“å‰domèŠ‚ç‚¹å†…å®¹ 
    // é‡æ–°æ¸²æŸ“
    this.state.Map.world.forEach((item, index) => {
        let cols = document.createElement('div');
        cols.className = 'cols';
        cols.key = index;
        item.forEach((itm, idx) => {
            let grid = document.createElement('div');
            grid.className = this.getClass(itm);
            grid.key = index + '-' + idx;
            cols.appendChild(grid)
        })
        divDom.appendChild(cols)
    })
}
```
è‡³äºå¦‚ä½•æ¸²æŸ“ï¼Œæ¸²æŸ“å“ªäº›æ–°å†…å®¹ï¼Œè¿™ä¸ªè¿˜éœ€è¦åŸºäºä¸€äº›å…¶ä»–çŠ¶æ€æ¡ä»¶çš„å˜åŒ–è¿›è¡Œé…ç½®ï¼Œå¦‚ï¼šåœ°å›¾é£Ÿç‰©åˆ·æ–°ã€è›‡å˜é•¿ã€é€Ÿåº¦åŠ å¿«ç­‰ã€‚

## æ¸¸æˆç»“æŸè®¾ç½®
æ—¢ç„¶æœ‰æ¸¸æˆåˆå§‹åŒ–é…ç½®ï¼Œé‚£ä¹ˆä¹Ÿåº”å½“æœ‰æ¸¸æˆç»“æŸè®¾ç½®ã€‚å½“æˆ‘ä»¬åˆ¤æ–­è›‡çš„çŠ¶æ€ä¸ºæ­»äº¡æˆ–è€…ç©å®¶éœ€è¦é‡æ–°å¼€å§‹æ¸¸æˆæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç»“æŸæ¸¸æˆ ğŸ‘‰ **å¸è½½ç»„ä»¶**ã€‚
> 1. é”®ç›˜ç›‘å¬äº‹ä»¶
> 2. å®šæ—¶å™¨äº‹ä»¶

å¯¹ `React` æœ‰ä¸€å®šäº†è§£çš„å¼€å‘è€…åº”è¯¥éƒ½çŸ¥é“ï¼Œå¸è½½ç»„ä»¶çš„åŠŸèƒ½éœ€è¦å®šä¹‰åœ¨ `componentWillUnmount()` å‡½æ•°ä¸­ã€‚å› æ­¤ï¼Œä»£ç å¦‚ä¸‹ï¼š

```js
/**
 * ç»„ä»¶æ¸…é™¤æ—¶ æ¸…é™¤ å®šæ—¶å™¨ å’Œ ç›‘å¬å‡½æ•°
 */
componentWillUnmount() {
    clearInterval(this.timer);
    window.removeEventListener('keydown', this.keyDown)
}
```

# æ¸¸æˆæ•ˆæœ
åŸºäºä»¥ä¸Šä¸€ç³»åˆ—æ“ä½œï¼Œè¿›è¡Œç›¸åº”çš„æ•´åˆå’Œå¸ƒç½®ï¼Œæˆ‘ä»¬çš„æ¸¸æˆå°±å¯ä»¥å®ç°å•¦ï¼ä¸‹é¢å°†é™„ä¸Šæ¸¸æˆçš„éƒ¨åˆ†æˆªå›¾ã€‚å¦‚æœ‰éœ€è¦äº†è§£è¯¦ç»†ä»£ç ï¼Œå¯ä»¥å»æˆ‘çš„ Github ä»“åº“ä¸­æŸ¥çœ‹ ğŸ‘‰ [GreedySnake](https://github.com/Douc1998/MyWebPage/tree/main/src/project/components/game/components/GreedySnake)

![æ¸¸æˆæˆªå›¾1](./Reactè´ªåƒè›‡å°æ¸¸æˆ/startGame.png)
![æ¸¸æˆæˆªå›¾2](./Reactè´ªåƒè›‡å°æ¸¸æˆ/GreedySnake1.png)
![æ¸¸æˆæˆªå›¾3](./Reactè´ªåƒè›‡å°æ¸¸æˆ/GreedySnake2.png)

---
**å¾ˆæ„Ÿè°¢ä½ èƒ½çœ‹åˆ°è¿™é‡Œï¼è°¢è°¢ï½**